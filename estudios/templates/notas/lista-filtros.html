{% comment %}
  <!-- prettier-ignore-start -->
    Cada grupo tiene una opción "todas" que indica que no hay preferencia, al
    seleccionarla, las demás opciones se deseleccionan. Para hacer esto, la opción
    "todas" envía su propia request con su valor vacío, y las demás envían una
    request compartida con la lista de valores. Así, se refleja la selección en la
    cookie
    
    Los parámetros son: 
    - campo: el campo del formulario 
    - cualquiera_label: texto para la opción de "no preferencia"
    - label: el texto a mostrar como título 
    - headers: los encabezados HTMX a incluir
  <!-- prettier-ignore-end -->
{% endcomment %}
{% load grupos_variantes %}

<div
  role="group"
  data-lista-filtros
  aria-labelledby="{{ campo.name }}_label"
  class="max-h-175px overflow-y-auto scroll-smooth"
>
  <header
    class="sticky top-0 flex aic justify-between gap-x-3 mb-2 elevado border-0! border-b-1!"
  >
    <h2 id="{{ campo.name }}_label">{{ label }}</h2>
    <div
      role="group"
      class="{{ 'flex aic mr-2 text-texto-sutil gap-x-1 pb-2px [&>button]:(rounded-full size-[1.375rem] fc bg-#0000000a dark:bg-#ffffff11 p-1 transition-[background-color]) [&_svg]:size-4'|expandir_variantes }}"
    >
      <button
        type="button"
        class="pover:bg-[--transparente-2]!"
        onclick="this.closest('[data-lista-filtros]').scrollTo(0, 0)"
        aria-label="Ir al principio"
      >
        {% include "notas/iconos.html#flecha_inicio" %}
      </button>
      <button
        type="button"
        class="pover:bg-[--transparente-2]!"
        onclick="this.closest('[data-lista-filtros]').scrollTo(0, this.closest('[data-lista-filtros]').scrollHeight)"
        aria-label="Ir al final"
      >
        {% include "notas/iconos.html#flecha_final" %}
      </button>
    </div>
  </header>

  <div class="lista">
    {% with lc="block p-[.375rem_.75rem] pl-5 border-l-3 border-#00000023 dark:border-[--transparente-2] font-bold select-none transition-[background-color,color,border-color] pover:(bg-[--transparente-1] border-l-[--transparente-2]) peer-focus-visible:ring-1 peer-checked:(bg-primario-50 border-l-primario text-primario-600) dark:peer-checked:(bg-primario-400 border-l-primario-700 text-primario-texto)"|expandir_variantes %}
      <input
        class="sr-only peer ninguno"
        type="radio"
        name="{{ campo.name }}"
        id="{{ campo.name }}_0"
        value
        {% if campo.initial|length == 0 or campo.initial is none %}
          checked
        {% endif %}
      />
      <label class="{{ lc }}" for="{{ campo.name }}_0"
        >{{ cualquiera_label|default:"Todos" }}</label
      >

      {% for valor, label in campo.field.choices %}
        <div>
          <input
            class="sr-only peer"
            type="checkbox"
            name="{{ campo.name }}"
            value="{{ valor }}"
            id="{{ campo.name }}_{{ forloop.counter }}"
            tabindex="-1"
            {% if valor == campo.initial or valor in campo.initial %}checked{% endif %}
          />
          <label class="{{ lc }}" for="{{ campo.name }}_{{ forloop.counter }}"
            >{{ label }}</label
          >
        </div>
      {% endfor %}
    {% endwith %}
  </div>
</div>
